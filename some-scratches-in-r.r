{"cells":[{"source":"<a href=\"https://www.kaggle.com/code/yussufkadir/some-scratches-in-r?scriptVersionId=240693965\" target=\"_blank\"><img align=\"left\" alt=\"Kaggle\" title=\"Open in Kaggle\" src=\"https://kaggle.com/static/images/open-in-kaggle.svg\"></a>","metadata":{},"cell_type":"markdown"},{"cell_type":"code","execution_count":1,"id":"1a8a823b","metadata":{"_execution_state":"idle","_uuid":"051d70d956493feee0c6d64651c6a088724dca2a","execution":{"iopub.execute_input":"2025-05-19T21:06:00.31663Z","iopub.status.busy":"2025-05-19T21:06:00.314467Z","iopub.status.idle":"2025-05-19T21:06:01.737966Z","shell.execute_reply":"2025-05-19T21:06:01.736207Z"},"papermill":{"duration":1.430794,"end_time":"2025-05-19T21:06:01.740393","exception":false,"start_time":"2025-05-19T21:06:00.309599","status":"completed"},"tags":[]},"outputs":[{"name":"stderr","output_type":"stream","text":["── \u001b[1mAttaching core tidyverse packages\u001b[22m ──────────────────────── tidyverse 2.0.0 ──\n","\u001b[32m✔\u001b[39m \u001b[34mdplyr    \u001b[39m 1.1.4     \u001b[32m✔\u001b[39m \u001b[34mreadr    \u001b[39m 2.1.5\n","\u001b[32m✔\u001b[39m \u001b[34mforcats  \u001b[39m 1.0.0     \u001b[32m✔\u001b[39m \u001b[34mstringr  \u001b[39m 1.5.1\n","\u001b[32m✔\u001b[39m \u001b[34mggplot2  \u001b[39m 3.5.1     \u001b[32m✔\u001b[39m \u001b[34mtibble   \u001b[39m 3.2.1\n","\u001b[32m✔\u001b[39m \u001b[34mlubridate\u001b[39m 1.9.3     \u001b[32m✔\u001b[39m \u001b[34mtidyr    \u001b[39m 1.3.1\n","\u001b[32m✔\u001b[39m \u001b[34mpurrr    \u001b[39m 1.0.2     \n"]},{"name":"stderr","output_type":"stream","text":["── \u001b[1mConflicts\u001b[22m ────────────────────────────────────────── tidyverse_conflicts() ──\n","\u001b[31m✖\u001b[39m \u001b[34mdplyr\u001b[39m::\u001b[32mfilter()\u001b[39m masks \u001b[34mstats\u001b[39m::filter()\n","\u001b[31m✖\u001b[39m \u001b[34mdplyr\u001b[39m::\u001b[32mlag()\u001b[39m    masks \u001b[34mstats\u001b[39m::lag()\n","\u001b[36mℹ\u001b[39m Use the conflicted package (\u001b[3m\u001b[34m<http://conflicted.r-lib.org/>\u001b[39m\u001b[23m) to force all conflicts to become errors\n"]},{"data":{"text/html":[],"text/latex":[],"text/markdown":[],"text/plain":["character(0)"]},"metadata":{},"output_type":"display_data"}],"source":["# This R environment comes with many helpful analytics packages installed\n","# It is defined by the kaggle/rstats Docker image: https://github.com/kaggle/docker-rstats\n","# For example, here's a helpful package to load\n","\n","library(tidyverse) # metapackage of all tidyverse packages\n","\n","# Input data files are available in the read-only \"../input/\" directory\n","# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n","\n","list.files(path = \"../input\")\n","\n","# You can write up to 20GB to the current directory (/kaggle/working/) that gets preserved as output when you create a version using \"Save & Run All\" \n","# You can also write temporary files to /kaggle/temp/, but they won't be saved outside of the current session"]},{"cell_type":"markdown","id":"b9e1e57b","metadata":{"papermill":{"duration":0.002193,"end_time":"2025-05-19T21:06:01.745207","exception":false,"start_time":"2025-05-19T21:06:01.743014","status":"completed"},"tags":[]},"source":["### 1. Simple Linear Regression"]},{"cell_type":"code","execution_count":2,"id":"a2420c77","metadata":{"execution":{"iopub.execute_input":"2025-05-19T21:06:01.782663Z","iopub.status.busy":"2025-05-19T21:06:01.751492Z","iopub.status.idle":"2025-05-19T21:06:01.887773Z","shell.execute_reply":"2025-05-19T21:06:01.885959Z"},"papermill":{"duration":0.143048,"end_time":"2025-05-19T21:06:01.890443","exception":false,"start_time":"2025-05-19T21:06:01.747395","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<table class=\"dataframe\">\n","<caption>A data.frame: 6 × 11</caption>\n","<thead>\n","\t<tr><th></th><th scope=col>mpg</th><th scope=col>cyl</th><th scope=col>disp</th><th scope=col>hp</th><th scope=col>drat</th><th scope=col>wt</th><th scope=col>qsec</th><th scope=col>vs</th><th scope=col>am</th><th scope=col>gear</th><th scope=col>carb</th></tr>\n","\t<tr><th></th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>\n","</thead>\n","<tbody>\n","\t<tr><th scope=row>Mazda RX4</th><td>21.0</td><td>6</td><td>160</td><td>110</td><td>3.90</td><td>2.620</td><td>16.46</td><td>0</td><td>1</td><td>4</td><td>4</td></tr>\n","\t<tr><th scope=row>Mazda RX4 Wag</th><td>21.0</td><td>6</td><td>160</td><td>110</td><td>3.90</td><td>2.875</td><td>17.02</td><td>0</td><td>1</td><td>4</td><td>4</td></tr>\n","\t<tr><th scope=row>Datsun 710</th><td>22.8</td><td>4</td><td>108</td><td> 93</td><td>3.85</td><td>2.320</td><td>18.61</td><td>1</td><td>1</td><td>4</td><td>1</td></tr>\n","\t<tr><th scope=row>Hornet 4 Drive</th><td>21.4</td><td>6</td><td>258</td><td>110</td><td>3.08</td><td>3.215</td><td>19.44</td><td>1</td><td>0</td><td>3</td><td>1</td></tr>\n","\t<tr><th scope=row>Hornet Sportabout</th><td>18.7</td><td>8</td><td>360</td><td>175</td><td>3.15</td><td>3.440</td><td>17.02</td><td>0</td><td>0</td><td>3</td><td>2</td></tr>\n","\t<tr><th scope=row>Valiant</th><td>18.1</td><td>6</td><td>225</td><td>105</td><td>2.76</td><td>3.460</td><td>20.22</td><td>1</td><td>0</td><td>3</td><td>1</td></tr>\n","</tbody>\n","</table>\n"],"text/latex":["A data.frame: 6 × 11\n","\\begin{tabular}{r|lllllllllll}\n","  & mpg & cyl & disp & hp & drat & wt & qsec & vs & am & gear & carb\\\\\n","  & <dbl> & <dbl> & <dbl> & <dbl> & <dbl> & <dbl> & <dbl> & <dbl> & <dbl> & <dbl> & <dbl>\\\\\n","\\hline\n","\tMazda RX4 & 21.0 & 6 & 160 & 110 & 3.90 & 2.620 & 16.46 & 0 & 1 & 4 & 4\\\\\n","\tMazda RX4 Wag & 21.0 & 6 & 160 & 110 & 3.90 & 2.875 & 17.02 & 0 & 1 & 4 & 4\\\\\n","\tDatsun 710 & 22.8 & 4 & 108 &  93 & 3.85 & 2.320 & 18.61 & 1 & 1 & 4 & 1\\\\\n","\tHornet 4 Drive & 21.4 & 6 & 258 & 110 & 3.08 & 3.215 & 19.44 & 1 & 0 & 3 & 1\\\\\n","\tHornet Sportabout & 18.7 & 8 & 360 & 175 & 3.15 & 3.440 & 17.02 & 0 & 0 & 3 & 2\\\\\n","\tValiant & 18.1 & 6 & 225 & 105 & 2.76 & 3.460 & 20.22 & 1 & 0 & 3 & 1\\\\\n","\\end{tabular}\n"],"text/markdown":["\n","A data.frame: 6 × 11\n","\n","| <!--/--> | mpg &lt;dbl&gt; | cyl &lt;dbl&gt; | disp &lt;dbl&gt; | hp &lt;dbl&gt; | drat &lt;dbl&gt; | wt &lt;dbl&gt; | qsec &lt;dbl&gt; | vs &lt;dbl&gt; | am &lt;dbl&gt; | gear &lt;dbl&gt; | carb &lt;dbl&gt; |\n","|---|---|---|---|---|---|---|---|---|---|---|---|\n","| Mazda RX4 | 21.0 | 6 | 160 | 110 | 3.90 | 2.620 | 16.46 | 0 | 1 | 4 | 4 |\n","| Mazda RX4 Wag | 21.0 | 6 | 160 | 110 | 3.90 | 2.875 | 17.02 | 0 | 1 | 4 | 4 |\n","| Datsun 710 | 22.8 | 4 | 108 |  93 | 3.85 | 2.320 | 18.61 | 1 | 1 | 4 | 1 |\n","| Hornet 4 Drive | 21.4 | 6 | 258 | 110 | 3.08 | 3.215 | 19.44 | 1 | 0 | 3 | 1 |\n","| Hornet Sportabout | 18.7 | 8 | 360 | 175 | 3.15 | 3.440 | 17.02 | 0 | 0 | 3 | 2 |\n","| Valiant | 18.1 | 6 | 225 | 105 | 2.76 | 3.460 | 20.22 | 1 | 0 | 3 | 1 |\n","\n"],"text/plain":["                  mpg  cyl disp hp  drat wt    qsec  vs am gear carb\n","Mazda RX4         21.0 6   160  110 3.90 2.620 16.46 0  1  4    4   \n","Mazda RX4 Wag     21.0 6   160  110 3.90 2.875 17.02 0  1  4    4   \n","Datsun 710        22.8 4   108   93 3.85 2.320 18.61 1  1  4    1   \n","Hornet 4 Drive    21.4 6   258  110 3.08 3.215 19.44 1  0  3    1   \n","Hornet Sportabout 18.7 8   360  175 3.15 3.440 17.02 0  0  3    2   \n","Valiant           18.1 6   225  105 2.76 3.460 20.22 1  0  3    1   "]},"metadata":{},"output_type":"display_data"},{"data":{"text/plain":["\n","Call:\n","lm(formula = mpg ~ wt, data = mtcars)\n","\n","Residuals:\n","    Min      1Q  Median      3Q     Max \n","-4.5432 -2.3647 -0.1252  1.4096  6.8727 \n","\n","Coefficients:\n","            Estimate Std. Error t value Pr(>|t|)    \n","(Intercept)  37.2851     1.8776  19.858  < 2e-16 ***\n","wt           -5.3445     0.5591  -9.559 1.29e-10 ***\n","---\n","Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n","\n","Residual standard error: 3.046 on 30 degrees of freedom\n","Multiple R-squared:  0.7528,\tAdjusted R-squared:  0.7446 \n","F-statistic: 91.38 on 1 and 30 DF,  p-value: 1.294e-10\n"]},"metadata":{},"output_type":"display_data"},{"data":{"text/html":["<table class=\"dataframe\">\n","<caption>A matrix: 2 × 2 of type dbl</caption>\n","<thead>\n","\t<tr><th></th><th scope=col>2.5 %</th><th scope=col>97.5 %</th></tr>\n","</thead>\n","<tbody>\n","\t<tr><th scope=row>(Intercept)</th><td>33.450500</td><td>41.119753</td></tr>\n","\t<tr><th scope=row>wt</th><td>-6.486308</td><td>-4.202635</td></tr>\n","</tbody>\n","</table>\n"],"text/latex":["A matrix: 2 × 2 of type dbl\n","\\begin{tabular}{r|ll}\n","  & 2.5 \\% & 97.5 \\%\\\\\n","\\hline\n","\t(Intercept) & 33.450500 & 41.119753\\\\\n","\twt & -6.486308 & -4.202635\\\\\n","\\end{tabular}\n"],"text/markdown":["\n","A matrix: 2 × 2 of type dbl\n","\n","| <!--/--> | 2.5 % | 97.5 % |\n","|---|---|---|\n","| (Intercept) | 33.450500 | 41.119753 |\n","| wt | -6.486308 | -4.202635 |\n","\n"],"text/plain":["            2.5 %     97.5 %   \n","(Intercept) 33.450500 41.119753\n","wt          -6.486308 -4.202635"]},"metadata":{},"output_type":"display_data"},{"data":{"text/html":["<table class=\"dataframe\">\n","<caption>A matrix: 3 × 3 of type dbl</caption>\n","<thead>\n","\t<tr><th></th><th scope=col>fit</th><th scope=col>lwr</th><th scope=col>upr</th></tr>\n","</thead>\n","<tbody>\n","\t<tr><th scope=row>1</th><td>23.92395</td><td>22.55284</td><td>25.29506</td></tr>\n","\t<tr><th scope=row>2</th><td>21.25171</td><td>20.12444</td><td>22.37899</td></tr>\n","\t<tr><th scope=row>3</th><td>18.57948</td><td>17.43342</td><td>19.72553</td></tr>\n","</tbody>\n","</table>\n"],"text/latex":["A matrix: 3 × 3 of type dbl\n","\\begin{tabular}{r|lll}\n","  & fit & lwr & upr\\\\\n","\\hline\n","\t1 & 23.92395 & 22.55284 & 25.29506\\\\\n","\t2 & 21.25171 & 20.12444 & 22.37899\\\\\n","\t3 & 18.57948 & 17.43342 & 19.72553\\\\\n","\\end{tabular}\n"],"text/markdown":["\n","A matrix: 3 × 3 of type dbl\n","\n","| <!--/--> | fit | lwr | upr |\n","|---|---|---|---|\n","| 1 | 23.92395 | 22.55284 | 25.29506 |\n","| 2 | 21.25171 | 20.12444 | 22.37899 |\n","| 3 | 18.57948 | 17.43342 | 19.72553 |\n","\n"],"text/plain":["  fit      lwr      upr     \n","1 23.92395 22.55284 25.29506\n","2 21.25171 20.12444 22.37899\n","3 18.57948 17.43342 19.72553"]},"metadata":{},"output_type":"display_data"}],"source":["# load the dataset with the data keyword\n","data(mtcars)\n","\n","# then you can check the first five rows with head keyword\n","head(mtcars)\n","\n","model <- lm(mpg ~ wt, data=mtcars)\n","\n","summary(model)\n","\n","confint(model)\n","\n","new_data <- data.frame(wt = c(2.5, 3.0, 3.5))\n","predict(model, new_data, interval='confidence')"]},{"cell_type":"markdown","id":"8b1455f3","metadata":{"papermill":{"duration":0.00296,"end_time":"2025-05-19T21:06:01.896496","exception":false,"start_time":"2025-05-19T21:06:01.893536","status":"completed"},"tags":[]},"source":["### 2. Simple logistic regression"]},{"cell_type":"code","execution_count":3,"id":"f684159f","metadata":{"execution":{"iopub.execute_input":"2025-05-19T21:06:01.906208Z","iopub.status.busy":"2025-05-19T21:06:01.904466Z","iopub.status.idle":"2025-05-19T21:06:01.951793Z","shell.execute_reply":"2025-05-19T21:06:01.949758Z"},"papermill":{"duration":0.05511,"end_time":"2025-05-19T21:06:01.954649","exception":false,"start_time":"2025-05-19T21:06:01.899539","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["\n","Call:\n","glm(formula = high_mpg ~ wt, family = binomial, data = mtcars)\n","\n","Coefficients:\n","            Estimate Std. Error z value Pr(>|z|)  \n","(Intercept)   19.950      8.336   2.393   0.0167 *\n","wt            -6.391      2.584  -2.473   0.0134 *\n","---\n","Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n","\n","(Dispersion parameter for binomial family taken to be 1)\n","\n","    Null deviance: 43.86  on 31  degrees of freedom\n","Residual deviance: 13.73  on 30  degrees of freedom\n","AIC: 17.73\n","\n","Number of Fisher Scoring iterations: 7\n"]},"metadata":{},"output_type":"display_data"},{"data":{"text/html":["<style>\n",".dl-inline {width: auto; margin:0; padding: 0}\n",".dl-inline>dt, .dl-inline>dd {float: none; width: auto; display: inline-block}\n",".dl-inline>dt::after {content: \":\\0020\"; padding-right: .5ex}\n",".dl-inline>dt:not(:first-of-type) {padding-left: .5ex}\n","</style><dl class=dl-inline><dt>(Intercept)</dt><dd>461310865.744429</dd><dt>wt</dt><dd>0.00167734953846457</dd></dl>\n"],"text/latex":["\\begin{description*}\n","\\item[(Intercept)] 461310865.744429\n","\\item[wt] 0.00167734953846457\n","\\end{description*}\n"],"text/markdown":["(Intercept)\n",":   461310865.744429wt\n",":   0.00167734953846457\n","\n"],"text/plain":[" (Intercept)           wt \n","4.613109e+08 1.677350e-03 "]},"metadata":{},"output_type":"display_data"},{"data":{"text/html":["<style>\n",".dl-inline {width: auto; margin:0; padding: 0}\n",".dl-inline>dt, .dl-inline>dd {float: none; width: auto; display: inline-block}\n",".dl-inline>dt::after {content: \":\\0020\"; padding-right: .5ex}\n",".dl-inline>dt:not(:first-of-type) {padding-left: .5ex}\n","</style><dl class=dl-inline><dt>1</dt><dd>3.97323173523675</dd><dt>2</dt><dd>0.777961541710745</dd><dt>3</dt><dd>-2.41730865181527</dd></dl>\n"],"text/latex":["\\begin{description*}\n","\\item[1] 3.97323173523675\n","\\item[2] 0.777961541710745\n","\\item[3] -2.41730865181527\n","\\end{description*}\n"],"text/markdown":["1\n",":   3.973231735236752\n",":   0.7779615417107453\n",":   -2.41730865181527\n","\n"],"text/plain":["         1          2          3 \n"," 3.9732317  0.7779615 -2.4173087 "]},"metadata":{},"output_type":"display_data"}],"source":["data(mtcars)\n","\n","mtcars$high_mpg <- ifelse(mtcars$mpg > 20, 1, 0)\n","\n","model <- glm(high_mpg ~ wt, data=mtcars, family=binomial)\n","\n","summary(model)\n","\n","exp(coef(model))\n","\n","new_data <- data.frame(wt = c(2.5, 3.0, 3.5))\n","predict(model, new_data, interval='response')"]},{"cell_type":"markdown","id":"4b08cece","metadata":{"papermill":{"duration":0.00332,"end_time":"2025-05-19T21:06:01.961444","exception":false,"start_time":"2025-05-19T21:06:01.958124","status":"completed"},"tags":[]},"source":["### 3. Simple KNN implementation."]},{"cell_type":"code","execution_count":4,"id":"1ea83156","metadata":{"execution":{"iopub.execute_input":"2025-05-19T21:06:01.971851Z","iopub.status.busy":"2025-05-19T21:06:01.970223Z","iopub.status.idle":"2025-05-19T21:06:02.122512Z","shell.execute_reply":"2025-05-19T21:06:02.120418Z"},"papermill":{"duration":0.160905,"end_time":"2025-05-19T21:06:02.125639","exception":false,"start_time":"2025-05-19T21:06:01.964734","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<table class=\"dataframe\">\n","<caption>A data.frame: 6 × 5</caption>\n","<thead>\n","\t<tr><th></th><th scope=col>Sepal.Length</th><th scope=col>Sepal.Width</th><th scope=col>Petal.Length</th><th scope=col>Petal.Width</th><th scope=col>Species</th></tr>\n","\t<tr><th></th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;fct&gt;</th></tr>\n","</thead>\n","<tbody>\n","\t<tr><th scope=row>1</th><td>5.1</td><td>3.5</td><td>1.4</td><td>0.2</td><td>setosa</td></tr>\n","\t<tr><th scope=row>2</th><td>4.9</td><td>3.0</td><td>1.4</td><td>0.2</td><td>setosa</td></tr>\n","\t<tr><th scope=row>3</th><td>4.7</td><td>3.2</td><td>1.3</td><td>0.2</td><td>setosa</td></tr>\n","\t<tr><th scope=row>4</th><td>4.6</td><td>3.1</td><td>1.5</td><td>0.2</td><td>setosa</td></tr>\n","\t<tr><th scope=row>5</th><td>5.0</td><td>3.6</td><td>1.4</td><td>0.2</td><td>setosa</td></tr>\n","\t<tr><th scope=row>6</th><td>5.4</td><td>3.9</td><td>1.7</td><td>0.4</td><td>setosa</td></tr>\n","</tbody>\n","</table>\n"],"text/latex":["A data.frame: 6 × 5\n","\\begin{tabular}{r|lllll}\n","  & Sepal.Length & Sepal.Width & Petal.Length & Petal.Width & Species\\\\\n","  & <dbl> & <dbl> & <dbl> & <dbl> & <fct>\\\\\n","\\hline\n","\t1 & 5.1 & 3.5 & 1.4 & 0.2 & setosa\\\\\n","\t2 & 4.9 & 3.0 & 1.4 & 0.2 & setosa\\\\\n","\t3 & 4.7 & 3.2 & 1.3 & 0.2 & setosa\\\\\n","\t4 & 4.6 & 3.1 & 1.5 & 0.2 & setosa\\\\\n","\t5 & 5.0 & 3.6 & 1.4 & 0.2 & setosa\\\\\n","\t6 & 5.4 & 3.9 & 1.7 & 0.4 & setosa\\\\\n","\\end{tabular}\n"],"text/markdown":["\n","A data.frame: 6 × 5\n","\n","| <!--/--> | Sepal.Length &lt;dbl&gt; | Sepal.Width &lt;dbl&gt; | Petal.Length &lt;dbl&gt; | Petal.Width &lt;dbl&gt; | Species &lt;fct&gt; |\n","|---|---|---|---|---|---|\n","| 1 | 5.1 | 3.5 | 1.4 | 0.2 | setosa |\n","| 2 | 4.9 | 3.0 | 1.4 | 0.2 | setosa |\n","| 3 | 4.7 | 3.2 | 1.3 | 0.2 | setosa |\n","| 4 | 4.6 | 3.1 | 1.5 | 0.2 | setosa |\n","| 5 | 5.0 | 3.6 | 1.4 | 0.2 | setosa |\n","| 6 | 5.4 | 3.9 | 1.7 | 0.4 | setosa |\n","\n"],"text/plain":["  Sepal.Length Sepal.Width Petal.Length Petal.Width Species\n","1 5.1          3.5         1.4          0.2         setosa \n","2 4.9          3.0         1.4          0.2         setosa \n","3 4.7          3.2         1.3          0.2         setosa \n","4 4.6          3.1         1.5          0.2         setosa \n","5 5.0          3.6         1.4          0.2         setosa \n","6 5.4          3.9         1.7          0.4         setosa "]},"metadata":{},"output_type":"display_data"},{"data":{"text/plain":["  Sepal.Length    Sepal.Width     Petal.Length    Petal.Width   \n"," Min.   :4.300   Min.   :2.000   Min.   :1.000   Min.   :0.100  \n"," 1st Qu.:5.100   1st Qu.:2.800   1st Qu.:1.600   1st Qu.:0.300  \n"," Median :5.800   Median :3.000   Median :4.350   Median :1.300  \n"," Mean   :5.843   Mean   :3.057   Mean   :3.758   Mean   :1.199  \n"," 3rd Qu.:6.400   3rd Qu.:3.300   3rd Qu.:5.100   3rd Qu.:1.800  \n"," Max.   :7.900   Max.   :4.400   Max.   :6.900   Max.   :2.500  \n","       Species  \n"," setosa    :50  \n"," versicolor:50  \n"," virginica :50  \n","                \n","                \n","                "]},"metadata":{},"output_type":"display_data"},{"name":"stdout","output_type":"stream","text":["'data.frame':\t150 obs. of  5 variables:\n"," $ Sepal.Length: num  5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...\n"," $ Sepal.Width : num  3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...\n"," $ Petal.Length: num  1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ...\n"," $ Petal.Width : num  0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...\n"," $ Species     : Factor w/ 3 levels \"setosa\",\"versicolor\",..: 1 1 1 1 1 1 1 1 1 1 ...\n"]},{"data":{"text/html":["<table class=\"dataframe\">\n","<caption>A data.frame: 6 × 5</caption>\n","<thead>\n","\t<tr><th></th><th scope=col>Sepal.Length</th><th scope=col>Sepal.Width</th><th scope=col>Petal.Length</th><th scope=col>Petal.Width</th><th scope=col>Species</th></tr>\n","\t<tr><th></th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;fct&gt;</th></tr>\n","</thead>\n","<tbody>\n","\t<tr><th scope=row>1</th><td>-0.8976739</td><td> 1.01560199</td><td>-1.335752</td><td>-1.311052</td><td>setosa</td></tr>\n","\t<tr><th scope=row>2</th><td>-1.1392005</td><td>-0.13153881</td><td>-1.335752</td><td>-1.311052</td><td>setosa</td></tr>\n","\t<tr><th scope=row>3</th><td>-1.3807271</td><td> 0.32731751</td><td>-1.392399</td><td>-1.311052</td><td>setosa</td></tr>\n","\t<tr><th scope=row>4</th><td>-1.5014904</td><td> 0.09788935</td><td>-1.279104</td><td>-1.311052</td><td>setosa</td></tr>\n","\t<tr><th scope=row>5</th><td>-1.0184372</td><td> 1.24503015</td><td>-1.335752</td><td>-1.311052</td><td>setosa</td></tr>\n","\t<tr><th scope=row>6</th><td>-0.5353840</td><td> 1.93331463</td><td>-1.165809</td><td>-1.048667</td><td>setosa</td></tr>\n","</tbody>\n","</table>\n"],"text/latex":["A data.frame: 6 × 5\n","\\begin{tabular}{r|lllll}\n","  & Sepal.Length & Sepal.Width & Petal.Length & Petal.Width & Species\\\\\n","  & <dbl> & <dbl> & <dbl> & <dbl> & <fct>\\\\\n","\\hline\n","\t1 & -0.8976739 &  1.01560199 & -1.335752 & -1.311052 & setosa\\\\\n","\t2 & -1.1392005 & -0.13153881 & -1.335752 & -1.311052 & setosa\\\\\n","\t3 & -1.3807271 &  0.32731751 & -1.392399 & -1.311052 & setosa\\\\\n","\t4 & -1.5014904 &  0.09788935 & -1.279104 & -1.311052 & setosa\\\\\n","\t5 & -1.0184372 &  1.24503015 & -1.335752 & -1.311052 & setosa\\\\\n","\t6 & -0.5353840 &  1.93331463 & -1.165809 & -1.048667 & setosa\\\\\n","\\end{tabular}\n"],"text/markdown":["\n","A data.frame: 6 × 5\n","\n","| <!--/--> | Sepal.Length &lt;dbl&gt; | Sepal.Width &lt;dbl&gt; | Petal.Length &lt;dbl&gt; | Petal.Width &lt;dbl&gt; | Species &lt;fct&gt; |\n","|---|---|---|---|---|---|\n","| 1 | -0.8976739 |  1.01560199 | -1.335752 | -1.311052 | setosa |\n","| 2 | -1.1392005 | -0.13153881 | -1.335752 | -1.311052 | setosa |\n","| 3 | -1.3807271 |  0.32731751 | -1.392399 | -1.311052 | setosa |\n","| 4 | -1.5014904 |  0.09788935 | -1.279104 | -1.311052 | setosa |\n","| 5 | -1.0184372 |  1.24503015 | -1.335752 | -1.311052 | setosa |\n","| 6 | -0.5353840 |  1.93331463 | -1.165809 | -1.048667 | setosa |\n","\n"],"text/plain":["  Sepal.Length Sepal.Width Petal.Length Petal.Width Species\n","1 -0.8976739    1.01560199 -1.335752    -1.311052   setosa \n","2 -1.1392005   -0.13153881 -1.335752    -1.311052   setosa \n","3 -1.3807271    0.32731751 -1.392399    -1.311052   setosa \n","4 -1.5014904    0.09788935 -1.279104    -1.311052   setosa \n","5 -1.0184372    1.24503015 -1.335752    -1.311052   setosa \n","6 -0.5353840    1.93331463 -1.165809    -1.048667   setosa "]},"metadata":{},"output_type":"display_data"},{"name":"stdout","output_type":"stream","text":["            Predicted\n","Actual       setosa versicolor virginica\n","  setosa         14          0         0\n","  versicolor      0         17         1\n","  virginica       0          1        12\n"]},{"name":"stdout","output_type":"stream","text":["[1] \"Accuracy: 95.56 %\"\n"]},{"name":"stdout","output_type":"stream","text":["            Predicted\n","Actual       setosa versicolor virginica\n","  setosa         14          0         0\n","  versicolor      0         16         2\n","  virginica       0          0        13\n"]},{"name":"stdout","output_type":"stream","text":["[1] \"Accuracy (k=5): 95.56 %\"\n"]}],"source":["data(iris)\n","\n","head(iris)\n","summary(iris)\n","str(iris)\n","\n","iris_scaled <- iris\n","iris_scaled[, 1:4] <- scale(iris[, 1:4])\n","head(iris_scaled)\n","\n","set.seed(123)\n","sample_indices <- sample(1:nrow(iris_scaled), size = 0.7 * nrow(iris_scaled))\n","\n","train_data <- iris_scaled[sample_indices, 1:4]\n","test_data <- iris_scaled[-sample_indices, 1:4]\n","\n","train_labels <- iris_scaled[sample_indices, 5]\n","test_labels <- iris_scaled[-sample_indices, 5]\n","\n","library(class)\n","\n","predictions <- knn(train = train_data, test = test_data, cl = train_labels, k = 3)\n","\n","confusion_matrix <- table(Actual = test_labels, Predicted = predictions)\n","print(confusion_matrix)\n","\n","accuracy <- sum(diag(confusion_matrix)) / sum(confusion_matrix)\n","print(paste(\"Accuracy:\", round(accuracy * 100, 2), \"%\"))\n","\n","predictions_k5 <- knn(train = train_data, test = test_data, cl = train_labels, k = 5)\n","confusion_matrix_k5 <- table(Actual = test_labels, Predicted = predictions_k5)\n","print(confusion_matrix_k5)\n","accuracy_k5 <- sum(diag(confusion_matrix_k5)) / sum(confusion_matrix_k5)\n","print(paste(\"Accuracy (k=5):\", round(accuracy_k5 * 100, 2), \"%\"))"]}],"metadata":{"kaggle":{"accelerator":"none","dataSources":[],"dockerImageVersionId":30749,"isGpuEnabled":false,"isInternetEnabled":true,"language":"r","sourceType":"notebook"},"kernelspec":{"display_name":"R","language":"R","name":"ir"},"language_info":{"codemirror_mode":"r","file_extension":".r","mimetype":"text/x-r-source","name":"R","pygments_lexer":"r","version":"4.4.0"},"papermill":{"default_parameters":{},"duration":5.470032,"end_time":"2025-05-19T21:06:02.25167","environment_variables":{},"exception":null,"input_path":"__notebook__.ipynb","output_path":"__notebook__.ipynb","parameters":{},"start_time":"2025-05-19T21:05:56.781638","version":"2.6.0"}},"nbformat":4,"nbformat_minor":5}