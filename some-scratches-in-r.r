{"cells":[{"source":"<a href=\"https://www.kaggle.com/code/yussufkadir/some-scratches-in-r?scriptVersionId=240351462\" target=\"_blank\"><img align=\"left\" alt=\"Kaggle\" title=\"Open in Kaggle\" src=\"https://kaggle.com/static/images/open-in-kaggle.svg\"></a>","metadata":{},"cell_type":"markdown"},{"cell_type":"code","execution_count":1,"id":"667a82eb","metadata":{"_execution_state":"idle","_uuid":"051d70d956493feee0c6d64651c6a088724dca2a","execution":{"iopub.execute_input":"2025-05-18T04:11:53.284342Z","iopub.status.busy":"2025-05-18T04:11:53.282305Z","iopub.status.idle":"2025-05-18T04:11:54.515682Z","shell.execute_reply":"2025-05-18T04:11:54.513892Z"},"papermill":{"duration":1.240234,"end_time":"2025-05-18T04:11:54.518174","exception":false,"start_time":"2025-05-18T04:11:53.27794","status":"completed"},"tags":[]},"outputs":[{"name":"stderr","output_type":"stream","text":["── \u001b[1mAttaching core tidyverse packages\u001b[22m ──────────────────────── tidyverse 2.0.0 ──\n","\u001b[32m✔\u001b[39m \u001b[34mdplyr    \u001b[39m 1.1.4     \u001b[32m✔\u001b[39m \u001b[34mreadr    \u001b[39m 2.1.5\n","\u001b[32m✔\u001b[39m \u001b[34mforcats  \u001b[39m 1.0.0     \u001b[32m✔\u001b[39m \u001b[34mstringr  \u001b[39m 1.5.1\n","\u001b[32m✔\u001b[39m \u001b[34mggplot2  \u001b[39m 3.5.1     \u001b[32m✔\u001b[39m \u001b[34mtibble   \u001b[39m 3.2.1\n","\u001b[32m✔\u001b[39m \u001b[34mlubridate\u001b[39m 1.9.3     \u001b[32m✔\u001b[39m \u001b[34mtidyr    \u001b[39m 1.3.1\n","\u001b[32m✔\u001b[39m \u001b[34mpurrr    \u001b[39m 1.0.2     \n"]},{"name":"stderr","output_type":"stream","text":["── \u001b[1mConflicts\u001b[22m ────────────────────────────────────────── tidyverse_conflicts() ──\n","\u001b[31m✖\u001b[39m \u001b[34mdplyr\u001b[39m::\u001b[32mfilter()\u001b[39m masks \u001b[34mstats\u001b[39m::filter()\n","\u001b[31m✖\u001b[39m \u001b[34mdplyr\u001b[39m::\u001b[32mlag()\u001b[39m    masks \u001b[34mstats\u001b[39m::lag()\n","\u001b[36mℹ\u001b[39m Use the conflicted package (\u001b[3m\u001b[34m<http://conflicted.r-lib.org/>\u001b[39m\u001b[23m) to force all conflicts to become errors\n"]},{"data":{"text/html":[],"text/latex":[],"text/markdown":[],"text/plain":["character(0)"]},"metadata":{},"output_type":"display_data"}],"source":["# This R environment comes with many helpful analytics packages installed\n","# It is defined by the kaggle/rstats Docker image: https://github.com/kaggle/docker-rstats\n","# For example, here's a helpful package to load\n","\n","library(tidyverse) # metapackage of all tidyverse packages\n","\n","# Input data files are available in the read-only \"../input/\" directory\n","# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n","\n","list.files(path = \"../input\")\n","\n","# You can write up to 20GB to the current directory (/kaggle/working/) that gets preserved as output when you create a version using \"Save & Run All\" \n","# You can also write temporary files to /kaggle/temp/, but they won't be saved outside of the current session"]},{"cell_type":"markdown","id":"7a795239","metadata":{"papermill":{"duration":0.001913,"end_time":"2025-05-18T04:11:54.522301","exception":false,"start_time":"2025-05-18T04:11:54.520388","status":"completed"},"tags":[]},"source":["### 1. Simple Linear Regression"]},{"cell_type":"code","execution_count":2,"id":"7c04900f","metadata":{"execution":{"iopub.execute_input":"2025-05-18T04:11:54.558022Z","iopub.status.busy":"2025-05-18T04:11:54.527549Z","iopub.status.idle":"2025-05-18T04:11:54.663241Z","shell.execute_reply":"2025-05-18T04:11:54.661517Z"},"papermill":{"duration":0.141527,"end_time":"2025-05-18T04:11:54.6656","exception":false,"start_time":"2025-05-18T04:11:54.524073","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<table class=\"dataframe\">\n","<caption>A data.frame: 6 × 11</caption>\n","<thead>\n","\t<tr><th></th><th scope=col>mpg</th><th scope=col>cyl</th><th scope=col>disp</th><th scope=col>hp</th><th scope=col>drat</th><th scope=col>wt</th><th scope=col>qsec</th><th scope=col>vs</th><th scope=col>am</th><th scope=col>gear</th><th scope=col>carb</th></tr>\n","\t<tr><th></th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>\n","</thead>\n","<tbody>\n","\t<tr><th scope=row>Mazda RX4</th><td>21.0</td><td>6</td><td>160</td><td>110</td><td>3.90</td><td>2.620</td><td>16.46</td><td>0</td><td>1</td><td>4</td><td>4</td></tr>\n","\t<tr><th scope=row>Mazda RX4 Wag</th><td>21.0</td><td>6</td><td>160</td><td>110</td><td>3.90</td><td>2.875</td><td>17.02</td><td>0</td><td>1</td><td>4</td><td>4</td></tr>\n","\t<tr><th scope=row>Datsun 710</th><td>22.8</td><td>4</td><td>108</td><td> 93</td><td>3.85</td><td>2.320</td><td>18.61</td><td>1</td><td>1</td><td>4</td><td>1</td></tr>\n","\t<tr><th scope=row>Hornet 4 Drive</th><td>21.4</td><td>6</td><td>258</td><td>110</td><td>3.08</td><td>3.215</td><td>19.44</td><td>1</td><td>0</td><td>3</td><td>1</td></tr>\n","\t<tr><th scope=row>Hornet Sportabout</th><td>18.7</td><td>8</td><td>360</td><td>175</td><td>3.15</td><td>3.440</td><td>17.02</td><td>0</td><td>0</td><td>3</td><td>2</td></tr>\n","\t<tr><th scope=row>Valiant</th><td>18.1</td><td>6</td><td>225</td><td>105</td><td>2.76</td><td>3.460</td><td>20.22</td><td>1</td><td>0</td><td>3</td><td>1</td></tr>\n","</tbody>\n","</table>\n"],"text/latex":["A data.frame: 6 × 11\n","\\begin{tabular}{r|lllllllllll}\n","  & mpg & cyl & disp & hp & drat & wt & qsec & vs & am & gear & carb\\\\\n","  & <dbl> & <dbl> & <dbl> & <dbl> & <dbl> & <dbl> & <dbl> & <dbl> & <dbl> & <dbl> & <dbl>\\\\\n","\\hline\n","\tMazda RX4 & 21.0 & 6 & 160 & 110 & 3.90 & 2.620 & 16.46 & 0 & 1 & 4 & 4\\\\\n","\tMazda RX4 Wag & 21.0 & 6 & 160 & 110 & 3.90 & 2.875 & 17.02 & 0 & 1 & 4 & 4\\\\\n","\tDatsun 710 & 22.8 & 4 & 108 &  93 & 3.85 & 2.320 & 18.61 & 1 & 1 & 4 & 1\\\\\n","\tHornet 4 Drive & 21.4 & 6 & 258 & 110 & 3.08 & 3.215 & 19.44 & 1 & 0 & 3 & 1\\\\\n","\tHornet Sportabout & 18.7 & 8 & 360 & 175 & 3.15 & 3.440 & 17.02 & 0 & 0 & 3 & 2\\\\\n","\tValiant & 18.1 & 6 & 225 & 105 & 2.76 & 3.460 & 20.22 & 1 & 0 & 3 & 1\\\\\n","\\end{tabular}\n"],"text/markdown":["\n","A data.frame: 6 × 11\n","\n","| <!--/--> | mpg &lt;dbl&gt; | cyl &lt;dbl&gt; | disp &lt;dbl&gt; | hp &lt;dbl&gt; | drat &lt;dbl&gt; | wt &lt;dbl&gt; | qsec &lt;dbl&gt; | vs &lt;dbl&gt; | am &lt;dbl&gt; | gear &lt;dbl&gt; | carb &lt;dbl&gt; |\n","|---|---|---|---|---|---|---|---|---|---|---|---|\n","| Mazda RX4 | 21.0 | 6 | 160 | 110 | 3.90 | 2.620 | 16.46 | 0 | 1 | 4 | 4 |\n","| Mazda RX4 Wag | 21.0 | 6 | 160 | 110 | 3.90 | 2.875 | 17.02 | 0 | 1 | 4 | 4 |\n","| Datsun 710 | 22.8 | 4 | 108 |  93 | 3.85 | 2.320 | 18.61 | 1 | 1 | 4 | 1 |\n","| Hornet 4 Drive | 21.4 | 6 | 258 | 110 | 3.08 | 3.215 | 19.44 | 1 | 0 | 3 | 1 |\n","| Hornet Sportabout | 18.7 | 8 | 360 | 175 | 3.15 | 3.440 | 17.02 | 0 | 0 | 3 | 2 |\n","| Valiant | 18.1 | 6 | 225 | 105 | 2.76 | 3.460 | 20.22 | 1 | 0 | 3 | 1 |\n","\n"],"text/plain":["                  mpg  cyl disp hp  drat wt    qsec  vs am gear carb\n","Mazda RX4         21.0 6   160  110 3.90 2.620 16.46 0  1  4    4   \n","Mazda RX4 Wag     21.0 6   160  110 3.90 2.875 17.02 0  1  4    4   \n","Datsun 710        22.8 4   108   93 3.85 2.320 18.61 1  1  4    1   \n","Hornet 4 Drive    21.4 6   258  110 3.08 3.215 19.44 1  0  3    1   \n","Hornet Sportabout 18.7 8   360  175 3.15 3.440 17.02 0  0  3    2   \n","Valiant           18.1 6   225  105 2.76 3.460 20.22 1  0  3    1   "]},"metadata":{},"output_type":"display_data"},{"data":{"text/plain":["\n","Call:\n","lm(formula = mpg ~ wt, data = mtcars)\n","\n","Residuals:\n","    Min      1Q  Median      3Q     Max \n","-4.5432 -2.3647 -0.1252  1.4096  6.8727 \n","\n","Coefficients:\n","            Estimate Std. Error t value Pr(>|t|)    \n","(Intercept)  37.2851     1.8776  19.858  < 2e-16 ***\n","wt           -5.3445     0.5591  -9.559 1.29e-10 ***\n","---\n","Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n","\n","Residual standard error: 3.046 on 30 degrees of freedom\n","Multiple R-squared:  0.7528,\tAdjusted R-squared:  0.7446 \n","F-statistic: 91.38 on 1 and 30 DF,  p-value: 1.294e-10\n"]},"metadata":{},"output_type":"display_data"},{"data":{"text/html":["<table class=\"dataframe\">\n","<caption>A matrix: 2 × 2 of type dbl</caption>\n","<thead>\n","\t<tr><th></th><th scope=col>2.5 %</th><th scope=col>97.5 %</th></tr>\n","</thead>\n","<tbody>\n","\t<tr><th scope=row>(Intercept)</th><td>33.450500</td><td>41.119753</td></tr>\n","\t<tr><th scope=row>wt</th><td>-6.486308</td><td>-4.202635</td></tr>\n","</tbody>\n","</table>\n"],"text/latex":["A matrix: 2 × 2 of type dbl\n","\\begin{tabular}{r|ll}\n","  & 2.5 \\% & 97.5 \\%\\\\\n","\\hline\n","\t(Intercept) & 33.450500 & 41.119753\\\\\n","\twt & -6.486308 & -4.202635\\\\\n","\\end{tabular}\n"],"text/markdown":["\n","A matrix: 2 × 2 of type dbl\n","\n","| <!--/--> | 2.5 % | 97.5 % |\n","|---|---|---|\n","| (Intercept) | 33.450500 | 41.119753 |\n","| wt | -6.486308 | -4.202635 |\n","\n"],"text/plain":["            2.5 %     97.5 %   \n","(Intercept) 33.450500 41.119753\n","wt          -6.486308 -4.202635"]},"metadata":{},"output_type":"display_data"},{"data":{"text/html":["<table class=\"dataframe\">\n","<caption>A matrix: 3 × 3 of type dbl</caption>\n","<thead>\n","\t<tr><th></th><th scope=col>fit</th><th scope=col>lwr</th><th scope=col>upr</th></tr>\n","</thead>\n","<tbody>\n","\t<tr><th scope=row>1</th><td>23.92395</td><td>22.55284</td><td>25.29506</td></tr>\n","\t<tr><th scope=row>2</th><td>21.25171</td><td>20.12444</td><td>22.37899</td></tr>\n","\t<tr><th scope=row>3</th><td>18.57948</td><td>17.43342</td><td>19.72553</td></tr>\n","</tbody>\n","</table>\n"],"text/latex":["A matrix: 3 × 3 of type dbl\n","\\begin{tabular}{r|lll}\n","  & fit & lwr & upr\\\\\n","\\hline\n","\t1 & 23.92395 & 22.55284 & 25.29506\\\\\n","\t2 & 21.25171 & 20.12444 & 22.37899\\\\\n","\t3 & 18.57948 & 17.43342 & 19.72553\\\\\n","\\end{tabular}\n"],"text/markdown":["\n","A matrix: 3 × 3 of type dbl\n","\n","| <!--/--> | fit | lwr | upr |\n","|---|---|---|---|\n","| 1 | 23.92395 | 22.55284 | 25.29506 |\n","| 2 | 21.25171 | 20.12444 | 22.37899 |\n","| 3 | 18.57948 | 17.43342 | 19.72553 |\n","\n"],"text/plain":["  fit      lwr      upr     \n","1 23.92395 22.55284 25.29506\n","2 21.25171 20.12444 22.37899\n","3 18.57948 17.43342 19.72553"]},"metadata":{},"output_type":"display_data"}],"source":["# load the dataset with the data keyword\n","data(mtcars)\n","\n","# then you can check the first five rows with head keyword\n","head(mtcars)\n","\n","model <- lm(mpg ~ wt, data=mtcars)\n","\n","summary(model)\n","\n","confint(model)\n","\n","new_data <- data.frame(wt = c(2.5, 3.0, 3.5))\n","predict(model, new_data, interval='confidence')"]},{"cell_type":"markdown","id":"31689654","metadata":{"papermill":{"duration":0.002555,"end_time":"2025-05-18T04:11:54.67107","exception":false,"start_time":"2025-05-18T04:11:54.668515","status":"completed"},"tags":[]},"source":["### 2. Simple logistic regression"]},{"cell_type":"code","execution_count":3,"id":"f7ba4343","metadata":{"execution":{"iopub.execute_input":"2025-05-18T04:11:54.679415Z","iopub.status.busy":"2025-05-18T04:11:54.677882Z","iopub.status.idle":"2025-05-18T04:11:54.722884Z","shell.execute_reply":"2025-05-18T04:11:54.721264Z"},"papermill":{"duration":0.051602,"end_time":"2025-05-18T04:11:54.725098","exception":false,"start_time":"2025-05-18T04:11:54.673496","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["\n","Call:\n","glm(formula = high_mpg ~ wt, family = binomial, data = mtcars)\n","\n","Coefficients:\n","            Estimate Std. Error z value Pr(>|z|)  \n","(Intercept)   19.950      8.336   2.393   0.0167 *\n","wt            -6.391      2.584  -2.473   0.0134 *\n","---\n","Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n","\n","(Dispersion parameter for binomial family taken to be 1)\n","\n","    Null deviance: 43.86  on 31  degrees of freedom\n","Residual deviance: 13.73  on 30  degrees of freedom\n","AIC: 17.73\n","\n","Number of Fisher Scoring iterations: 7\n"]},"metadata":{},"output_type":"display_data"},{"data":{"text/html":["<style>\n",".dl-inline {width: auto; margin:0; padding: 0}\n",".dl-inline>dt, .dl-inline>dd {float: none; width: auto; display: inline-block}\n",".dl-inline>dt::after {content: \":\\0020\"; padding-right: .5ex}\n",".dl-inline>dt:not(:first-of-type) {padding-left: .5ex}\n","</style><dl class=dl-inline><dt>(Intercept)</dt><dd>461310865.744429</dd><dt>wt</dt><dd>0.00167734953846457</dd></dl>\n"],"text/latex":["\\begin{description*}\n","\\item[(Intercept)] 461310865.744429\n","\\item[wt] 0.00167734953846457\n","\\end{description*}\n"],"text/markdown":["(Intercept)\n",":   461310865.744429wt\n",":   0.00167734953846457\n","\n"],"text/plain":[" (Intercept)           wt \n","4.613109e+08 1.677350e-03 "]},"metadata":{},"output_type":"display_data"},{"data":{"text/html":["<style>\n",".dl-inline {width: auto; margin:0; padding: 0}\n",".dl-inline>dt, .dl-inline>dd {float: none; width: auto; display: inline-block}\n",".dl-inline>dt::after {content: \":\\0020\"; padding-right: .5ex}\n",".dl-inline>dt:not(:first-of-type) {padding-left: .5ex}\n","</style><dl class=dl-inline><dt>1</dt><dd>3.97323173523675</dd><dt>2</dt><dd>0.777961541710745</dd><dt>3</dt><dd>-2.41730865181527</dd></dl>\n"],"text/latex":["\\begin{description*}\n","\\item[1] 3.97323173523675\n","\\item[2] 0.777961541710745\n","\\item[3] -2.41730865181527\n","\\end{description*}\n"],"text/markdown":["1\n",":   3.973231735236752\n",":   0.7779615417107453\n",":   -2.41730865181527\n","\n"],"text/plain":["         1          2          3 \n"," 3.9732317  0.7779615 -2.4173087 "]},"metadata":{},"output_type":"display_data"}],"source":["data(mtcars)\n","\n","mtcars$high_mpg <- ifelse(mtcars$mpg > 20, 1, 0)\n","\n","model <- glm(high_mpg ~ wt, data=mtcars, family=binomial)\n","\n","summary(model)\n","\n","exp(coef(model))\n","\n","new_data <- data.frame(wt = c(2.5, 3.0, 3.5))\n","predict(model, new_data, interval='response')"]}],"metadata":{"kaggle":{"accelerator":"none","dataSources":[],"dockerImageVersionId":30749,"isGpuEnabled":false,"isInternetEnabled":true,"language":"r","sourceType":"notebook"},"kernelspec":{"display_name":"R","language":"R","name":"ir"},"language_info":{"codemirror_mode":"r","file_extension":".r","mimetype":"text/x-r-source","name":"R","pygments_lexer":"r","version":"4.4.0"},"papermill":{"default_parameters":{},"duration":4.686248,"end_time":"2025-05-18T04:11:54.850048","environment_variables":{},"exception":null,"input_path":"__notebook__.ipynb","output_path":"__notebook__.ipynb","parameters":{},"start_time":"2025-05-18T04:11:50.1638","version":"2.6.0"}},"nbformat":4,"nbformat_minor":5}